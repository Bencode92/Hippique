<!DOCTYPE html>
<html lang="fr">
<!-- Reste du code inchangé... -->
<!-- Je ne modifie que la partie spécifique de la fonction normaliserNom dans le module scorePredictor -->

<head>
    <!-- ... Garder tout le contenu existant ... -->
</head>
<body>
    <!-- ... Garder tout le contenu existant ... -->

    <script>
        // Module de chargement des courses - intégré directement dans index.html
        const coursesLoader = {
            // ... Garder tout le contenu existant ...
        };

        // Module pour le calcul du score prédictif
        const scorePredictor = {
            // Données de classement mises en cache
            data: {
                chevaux: null,
                jockeys: null,
                entraineurs: null,
                eleveurs: null,
                proprietaires: null
            },
            
            // ... Garder les autres fonctions inchangées ...
            
            // Fonction pour normaliser et nettoyer un nom
            normaliserNom(nom) {
                if (!nom) return "";
                
                // Convertir en majuscules et supprimer les espaces superflus
                let nomNormalise = nom.toUpperCase().trim();
                
                // CORRECTION: Amélioration des expressions régulières pour supprimer tous les formats
                // de suffixes techniques pour les chevaux (M.PS., F.PS., M.P.S., F.P.S., etc.)
                if (nomNormalise) {
                    // Capturer tout ce qui précède différents formats de suffixes techniques
                    const regexCheval = /^(.+?)(?:\s+[MF]\.?P\.?S\.?.*|\s+GB\s+F\.?P\.?S\.?.*|\s+\d+A\..*|\s+\(SUP\).*|\s+\d+\s*a\..*|\s+IRE\s+.*|\s+\d+\s*ans?.*|\s+\d{1,2}[,.]\d{1,2}%.*|\s+\d{1,2}%.*|\s+\(.*\).*)$/i;
                    
                    const match = nomNormalise.match(regexCheval);
                    if (match && match[1]) {
                        nomNormalise = match[1].trim();
                        console.log(`Nom nettoyé: "${nom}" -> "${nomNormalise}"`);
                    }
                }
                
                // Standardiser les préfixes
                nomNormalise = nomNormalise.replace(/^M\.\s*/i, "MR ")
                                        .replace(/^MME\.\s*/i, "MME ")
                                        .replace(/^MLLE\.\s*/i, "MLLE ");
                
                // Standardiser les abréviations connues
                const abreviations = {
                    "RY": "ROGER-YVES",
                    "JC": "JEAN-CLAUDE",
                    "MT": "MARIE-THERESE",
                    "P DE": "PRUDENCE DE",
                    "C.": "CHLOE"
                };
                
                // Remplacer les abréviations connues
                for (const [abrev, complet] of Object.entries(abreviations)) {
                    // Recherche avec limites de mots pour éviter les faux positifs
                    const regex = new RegExp(`\\b${abrev}\\b`, 'g');
                    nomNormalise = nomNormalise.replace(regex, complet);
                }
                
                return nomNormalise;
            },
            
            // ... Garder les autres fonctions inchangées ...
        };

        document.addEventListener('DOMContentLoaded', function() {
            // ... Garder tout le contenu existant ...
        });
    </script>
</body>
</html>